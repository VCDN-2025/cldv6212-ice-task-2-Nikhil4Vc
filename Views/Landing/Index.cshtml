@model CharityIce2.Models.RegisterModel
@{
    ViewData["Title"] = "Landing Page";
}

<ul class="nav nav-tabs" id="landingTab" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active" id="charity-tab" data-bs-toggle="tab" data-bs-target="#charity" type="button" role="tab" aria-controls="charity" aria-selected="true">Charity</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button" role="tab" aria-controls="profile" aria-selected="false">Profile</button>
    </li>
</ul>

<div class="tab-content mt-3" id="landingTabContent">

    <!-- Charity Tab -->
    <div class="tab-pane fade show active" id="charity" role="tabpanel" aria-labelledby="charity-tab">
        <form asp-action="UploadCharityDocument" asp-controller="Landing" method="post" enctype="multipart/form-data">
            <div class="mb-3">
                <input type="file" name="charityDocument" class="form-control" />
            </div>
            <button type="submit" class="btn btn-primary">Upload Document</button>
        </form>

        @* Show upload result only *@
        @if (ViewBag.Message != null)
        {
            <div class="mt-2 alert alert-info">@ViewBag.Message</div>
        }

        @* Optional: show uploaded file link if you store the URL *@
        @if (ViewBag.FileUrl != null)
        {
            <p>Uploaded File: <a href="@ViewBag.FileUrl" target="_blank">View Document</a></p>
        }
    </div>

    <!-- Profile Tab -->
    <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
        <form asp-action="UpdateProfile" asp-controller="Landing" method="post" enctype="multipart/form-data">
            @Html.AntiForgeryToken()

            <!-- Full Name -->
            <div class="mb-3">
                <label asp-for="FullName" class="form-label"></label>
                <input asp-for="FullName" class="form-control" />
                <span asp-validation-for="FullName" class="text-danger"></span>
            </div>

            <!-- Email -->
            <div class="mb-3">
                <label class="form-label">Email</label>
                <input class="form-control" value="@Model.Email" readonly />
                <input type="hidden" asp-for="Email" />
                <span asp-validation-for="Email" class="text-danger"></span>
            </div>

            <!-- Password -->
            <div class="mb-3">
                <label asp-for="Password" class="form-label"></label>
                <input asp-for="Password" class="form-control" type="password" />
                <span asp-validation-for="Password" class="text-danger"></span>
            </div>

            <!-- Profile Picture -->
            <div class="mb-3">
                <label asp-for="ProfilePicture" class="form-label"></label>
                <input asp-for="ProfilePicture" class="form-control" type="file" onchange="previewProfileImage(event)" />
                <span asp-validation-for="ProfilePicture" class="text-danger"></span>
            </div>

            <!-- Preview -->
            @if (!string.IsNullOrEmpty(Model.ProfilePicturePath))
            {
                <div class="mb-3 text-center">
                    <img src="@Model.ProfilePicturePath" class="img-thumbnail" style="max-height:150px;" />
                </div>
            }
            <div class="mb-3 text-center">
                <img id="profilePreview" class="img-thumbnail" style="display:none; max-height:150px;" />
            </div>

            <div class="d-grid">
                <button type="submit" class="btn btn-primary">Update Profile</button>
            </div>

            @if (ViewBag.ProfileMessage != null)
            {
                <div class="mt-2 alert alert-info">@ViewBag.ProfileMessage</div>
            }
        </form>
    </div>
</div>

<script>
    function previewProfileImage(event) {
        const reader = new FileReader();
        reader.onload = function () {
            const output = document.getElementById('profilePreview');
            output.src = reader.result;
            output.style.display = 'block';
        };
        reader.readAsDataURL(event.target.files[0]);
    }
</script>

@section Scripts {
    @await Html.PartialAsync("_ValidationScriptsPartial")
}

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
